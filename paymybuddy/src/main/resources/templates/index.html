<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head>
        <title>PayMyBuddy App</title>
        <meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
    	  
    	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="/styles.css">
        
    </head>
    <body sec:authorize="isAuthenticated()">
        <header>
        	<span id="logo">PayMyBuddy</span>
        </header>
        
        <button type="submit" th:onclick="|window.location.href='/user/fuck'|">FUCK</button>
	
		<!-- used to remain on page when calling api -->
		<iframe name="hiddenFrame" class="hide"></iframe>
	
		<!-- Form to add friend connection -->
        <form th:action="@{/user/addconnection}" method="post" target="hiddenFrame">
  			<div class="form-group">
    			<label for="inputEmail">Email address</label>
    			<input name="email" id="email" type="text" class="form-control my-2 mx-2" placeholder="Enter email">
  			</div>
  			<button type="submit" class="btn btn-primary">Add Connection</button>
		</form>
		
		<!-- Form to make a payment -->
		<form th:action="@{/executePayment}" method="post" target="hiddenFrame">
			<select class="form-select" name="creditorEmail" >
				<option value="0">Select friend</option>
  				<option th:each="creditor : ${friends}"
  						th:value=${creditor.email} 
  						th:text="${creditor.firstname + ' ' + creditor.lastname}"></option>
			</select>
			<input name="description" type="text" th:value="${description}" placeholder="Enter a description">
			<input name="amount" type="number" th:value="${amount}" placeholder="Choose ammount">
			<input name="Execute" type="submit">
		</form>
		<!-- Payment history -->	
		<table class="table">
			<thead class="thead-light">
				<tr>
					<th class="text-left">From</th>
					<th class="text-left">To</th>
					<th class="text-left">Date</th>
					<th class="text-left">Description</th>
					<th class="text-left">value</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="payment : ${payments}">
					<td th:text="${payment.creditorName}"></td>
					<td th:text="${payment.debitorName}"></td>
					<td th:text="${payment.datetime}"></td>
					<td th:text="${payment.description}"></td>
					<td th:text="${payment.amount}"></td>
				</tr>
			</tbody>
		</table>
		
		
    </body>
</html>