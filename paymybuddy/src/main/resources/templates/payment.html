<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head>
        <title>PayMyBuddy App - Payment</title>
        <meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
    	  
    	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="/styles.css">
        
    </head>
    <body sec:authorize="isAuthenticated()">
        <header>
        	<span id="logo">PayMyBuddy</span>
        </header>
        
		<!-- Form to make a payment -->
		<form th:action="@{/executePayment}" th:object="${paymentForm}" method="post" >
			<select class="form-select" th:field="*{creditorEmail}" >
				<option value="0">Select friend</option>
  				<option th:each="creditor : ${friends}"
  						th:value=${creditor.email} 
  						th:text="${creditor.firstname + ' ' + creditor.lastname}"></option>
			</select>
			<span th:if="${#fields.hasErrors('creditorEmail')}" th:errors="*{creditorEmail}">Name Error</span>
			
			<input type="text" th:field="*{description}" placeholder="Enter a description">
			<span th:if="${#fields.hasErrors('description')}" th:errors="*{description}">Name Error</span>
			
			<input type="number" th:field="*{amount}" placeholder="Choose ammount">
			<span th:if="${#fields.hasErrors('amount')}" th:errors="*{amount}">Name Error</span>
			
			<input name="Execute" type="submit">
		</form>
		<!-- Payment history -->	
		<table class="table">
			<thead class="thead-light">
				<tr>
					<th class="text-left">From</th>
					<th class="text-left">To</th>
					<th class="text-left">Date</th>
					<th class="text-left">Description</th>
					<th class="text-left">value</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="payment : ${payments}">
					<td th:text="${payment.creditorName}"></td>
					<td th:text="${payment.debitorName}"></td>
					<td th:text="${payment.datetime}"></td>
					<td th:text="${payment.description}"></td>
					<td th:text="${payment.amount}"></td>
				</tr>
			</tbody>
		</table>
		
    </body>
</html>